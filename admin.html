<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MACRO GYM - Administrador</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        .admin-section {
            padding: 120px 20px 80px;
            background-color: #f8f8f8;
            position: relative;
        }
        
        .admin-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("img/pattern.png");
            opacity: 0.05;
            z-index: 0;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: var(--sombra-media);
            padding: 40px;
            position: relative;
            z-index: 1;
        }
        
        .admin-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .admin-header h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--fondo-oscuro);
        }
        
        .admin-actions {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .admin-search {
            display: flex;
            gap: 10px;
            flex: 1;
            max-width: 500px;
        }
        
        .admin-search input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            font-family: "Montserrat", sans-serif;
        }
        
        .admin-buttons {
            display: flex;
            gap: 10px;
        }
        
        .admin-button {
            background-color: var(--fondo-oscuro);
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: var(--transicion);
        }
        
        .admin-button:hover {
            background-color: var(--azul-logo);
            transform: translateY(-3px);
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .admin-table th, 
        .admin-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .admin-table th {
            background-color: var(--fondo-oscuro);
            color: white;
            position: sticky;
            top: 0;
        }
        
        .admin-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .table-container {
            max-height: 500px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .no-data {
            text-align: center;
            padding: 30px;
            color: #888;
        }
        
        @media screen and (max-width: 768px) {
            .admin-actions {
                flex-direction: column;
            }
            
            .admin-search {
                max-width: 100%;
            }
            
            .admin-table {
                font-size: 0.9rem;
            }
            
            .admin-container {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <!-- ボタンを上に戻る -->
    <button id="back-to-top" class="back-to-top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <header>
        <nav class="navbar">
            <div class="navbar-container">
                <div class="logo">
                    <a href="Index.html">
                        <img src="img/logo.png" alt="Logo MacroGym Fitness">
                    </a>
                </div>
                <div class="menu-toggle" id="mobile-menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item"><a href="Index.html" class="nav-link">Inicio</a></li>
                    <li class="nav-item"><a href="inscripcion.html" class="nav-link">Registro</a></li>
                    
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section class="admin-section">
            <div class="admin-container">
                <div class="admin-header">
                    <h2>Gestión de suscriptores</h2>
                    <div class="section-divider">
                        <span></span>
                        <i class="fas fa-users-cog"></i>
                        <span></span>
                    </div>
                    <p>Gestionar datos de usuarios registrados</p>
                </div>
                
                <div class="admin-actions">
                    <div class="admin-search">
                        <input type="text" id="searchInput" placeholder="Buscar por Nombre, Apellido o Numero de Telefono">
                        <button class="admin-button" id="searchButton">
                            <i class="fas fa-search"></i> Buscar
                        </button>
                    </div>
                    
                    <div class="admin-buttons">
                        <button class="admin-button" id="exportExcel">
                            <i class="fas fa-file-excel"></i> Exportar a Excel
                        </button>
                        <button class="admin-button" id="clearData">
                            <i class="fas fa-trash"></i> Borrar Datos
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="admin-table" id="inscripcionTable">
                        <thead>
                            <tr>
                                <th>Apellido</th>
                                <th>Nombre</th>
                                <th>Numero de Identificacion</th>
                                <th>Numero de Telefono</th>
                                <th>Correo Electronico</th>
                                <th>Plan</th>
                                <th>Horario</th>
                                <th>Fecha de Registro</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- JavaScriptでデータが挿入されます -->
                        </tbody>
                    </table>
                    <div id="noData" class="no-data">
                        <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                        <p>No hay datos de Registro</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-main">
            <div class="footer-content">
                <div class="footer-info">
                    <div class="footer-logo">
                        <img src="img/logo.png" alt="Logo MacroGym Fitness">
                    </div>
                    <p>MacroGym Fitness es tu mejor opción con equipos de última generación y entrenadores profesionales para ayudarte a alcanzar tus objetivos de entrenamiento.</p>
                </div>
                <div class="footer-links">
                    <h3>Enlaces Rapidos</h3>
                    <ul>
                        <li><a href="Index.html">Hogar</a></li>
                        <li><a href="inscripcion.html">Registro</a></li>
                        <li><a href="Index.html#contacto">Consulta</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>dirección de contacto</h3>
                    <div class="footer-contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <p>Av. Francisco Acuña De Figueroa casi, Asunción 001102</p>
                    </div>
                    <div class="footer-contact-item">
                        <i class="fas fa-phone"></i>
                        <p>+595 991 765 892</p>
                    </div>
                    <div class="footer-contact-item">
                        <i class="fas fa-envelope"></i>
                        <p>info@macrogym.com</p>
                    </div>
                </div>
                <div class="footer-newsletter">
                    <h3>Suscripción al boletín informativo</h3>
                    <p>Recibe noticias, promociones y consejos de fitness por correo electrónico.</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Correo Electronico">
                        <button type="submit"><i class="fas fa-arrow-right"></i></button>
                    </form>
                </div>
            </div>
            <div class="footer-social">
                <a href="https://www.facebook.com/macrogympy/?locale=es_LA" target="_blank" class="social-icon">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://www.instagram.com/macrogymfitness/" target="_blank" class="social-icon">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://api.whatsapp.com/send?phone=%2B595991765892" target="_blank" class="social-icon">
                    <i class="fab fa-whatsapp"></i>
                </a>
                <a href="#" target="_blank" class="social-icon">
                    <i class="fab fa-youtube"></i>
                </a>
            </div>
        </div>
        <div class="footer-bottom">
            <p class="copyright">Copyright © 2025 - MacroGym Fitness Todos los derechos reservados</p>
        </div>
    </footer>

    <!-- スクリプト -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // モバイルメニュー
            const mobileMenu = document.getElementById('mobile-menu');
            const navMenu = document.querySelector('.nav-menu');
            
            mobileMenu.addEventListener('click', function() {
                mobileMenu.classList.toggle('active');
                navMenu.classList.toggle('active');
            });

            // リンクをクリックしたときにメニューを閉じる
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.remove('active');
                    navMenu.classList.remove('active');
                });
            });

            // トップに戻るボタン
            const backToTopButton = document.getElementById('back-to-top');
            
            window.addEventListener('scroll', function() {
                if (window.scrollY > 300) {
                    backToTopButton.classList.add('visible');
                } else {
                    backToTopButton.classList.remove('visible');
                }
            });
            
            backToTopButton.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });

            // テーブルデータの読み込みと表示
            const tableBody = document.getElementById('tableBody');
            const noData = document.getElementById('noData');
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            const exportExcelButton = document.getElementById('exportExcel');
            const clearDataButton = document.getElementById('clearData');
            
            // ローカルストレージからデータを読み込む
            function loadData() {
                const data = JSON.parse(localStorage.getItem('inscripcionData')) || [];
                return data;
            }
            
            // テーブルにデータを表示する
            function displayData(data) {
                tableBody.innerHTML = '';
                
                if (data.length === 0) {
                    noData.style.display = 'block';
                    return;
                }
                
                noData.style.display = 'none';
                
                data.forEach(item => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${item.apellido}</td>
                        <td>${item.nombre}</td>
                        <td>${item.cedula}</td>
                        <td>${item.telefono}</td>
                        <td>${item.email}</td>
                        <td>${item.plan}</td>
                        <td>${item.horario}</td>
                        <td>${item.fecha_inscripcion}</td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
            
            // 検索機能
            function searchData() {
                const searchTerm = searchInput.value.toLowerCase();
                const data = loadData();
                
                if (!searchTerm) {
                    displayData(data);
                    return;
                }
                
                const filteredData = data.filter(item => 
                    item.nombre.toLowerCase().includes(searchTerm) ||
                    item.apellido.toLowerCase().includes(searchTerm) ||
                    item.telefono.includes(searchTerm) ||
                    item.email.toLowerCase().includes(searchTerm)
                );
                
                displayData(filteredData);
            }
            
            // Excelにエクスポート
            function exportToExcel() {
                const data = loadData();
                
                if (data.length === 0) {
                    alert('No hay Datos para Exportar');
                    return;
                }
                
                // SheetJSを使用してExcelファイルを作成
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "登録者リスト");
                
                // ファイル名に日付を追加
                const date = new Date();
                const fileName = `MACROGYM_登録者リスト_${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}.xlsx`;
                
                // ファイルをダウンロード
                XLSX.writeFile(wb, fileName);
            }
            
            // データをクリア
            function clearAllData() {
                if (confirm('すべての登録データを削除してもよろしいですか？この操作は元に戻せません。')) {
                    localStorage.removeItem('inscripcionData');
                    displayData([]);
                }
            }
            
            // イベントリスナーの設定
            searchButton.addEventListener('click', searchData);
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    searchData();
                }
            });
            
            exportExcelButton.addEventListener('click', exportToExcel);
            clearDataButton.addEventListener('click', clearAllData);
            
            // 初期データの表示
            displayData(loadData());
        });
    </script>
</body>
</html>
